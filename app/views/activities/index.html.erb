<div class='container-index p-3 '>
  <h1>Activities</h1>

  <!-- SEARCH BAR -->
  <%= form_tag activities_path, method: :get do %>
    <%= text_field_tag :query,
      params[:query],
      class: 'form-control',
      placeholder: '🔍Search by sport or location..'
    %>
    <%= submit_tag "Search", class: "btn btn-action" %>
  <% end  %>
  <!-- / SEARCH BAR -->

  <div>
    <% @activities.each do |activity| %>
    <% unless activity.players.count == activity.player_limit %>
      <%= link_to(activity_path(activity)) do %>
        <div class="card-activity-index"> 
          <%= image_tag "#{activity.sport.name.downcase}.jpg", class: 'card-activity-image' %>
          <div class="card-activity-index-infos border-bottom">
            <div>
              <h2 class='mb-2'><%= activity.title.capitalize %></h2>
              <p class='mb-1'><%= activity.location %></p>
              <p class='mb-1'><%= activity.start_time.strftime("%A, %B %-d, %H:%M") %></p>
            </div>
            <a class="card-activity-index-btn btn btn-sport" href="#"><%= activity.sport.name %></a>
          </div>
          <div class="card-activity-index-players">
            <div class="mr-8 card-activity-index-host">
              <img src="https://kitt.lewagon.com/placeholder/users/nati95" class="avatar-large" />
            </div>
            <div class="card-activity-index-player">
              <img src="https://kitt.lewagon.com/placeholder/users/arielgarbarsky" class="avatar" />
              <img src="https://kitt.lewagon.com/placeholder/users/szkamens" class="avatar" />
              <img src="https://kitt.lewagon.com/placeholder/users/vinzka" class="avatar" />
            <div class='card-activity-index-ct'>
              <% if activity.players.count > 4  %>
                <span>+<%= activity.players.count - 4 %> </span>
              <% else  %>
              <% end %>
            </div>
            </div>
            <div class='card-activity-index-nd'>
              <p><em><strong><%= pluralize(activity.player_limit - activity.players.count, 'player')%> needed </strong></em></p>
            </div>
          </div>
        </div>
      <% end %>
      <p></p>
  
  <%# begin comment %>
      <!--<%# <p><strong>Host: </strong><%= activity.user.username %></p>-->
      <%# <p><strong>Players: </strong> %>
      <%# <% if activity.players.count > 4 %>
        <%# <%= activity.users.take(3).map { |u| u.username }.join(', ') %> 
        <%# +<%= activity.players.count - 3 %>  
        <%# <% else %>  
        <%# <%= activity.users.take(3).map { |u| u.username }.join(', ') %> 
      <%# <% end %> 
      <%# </p> %>
    <% end %>
    <% end %>
  </div>
</div>
